---
// Header Component with Navigation
import Search from './Search.astro';
import DarkModeToggle from './DarkModeToggle.astro';
import LanguageSelector from './LanguageSelector.astro';
---

<header class="fixed top-0 left-0 right-0 z-50 backdrop-blur-lg bg-white/80 dark:bg-gray-900/80 border-b border-gray-200/20 dark:border-gray-700/20 shadow-lg">
  <nav class="container mx-auto px-4 lg:px-6">
    <div class="flex items-center justify-between h-16 lg:h-20">
      <!-- Logo -->
      <a href="/" class="flex items-center space-x-3 group" aria-label="THE FUTURE 3D - Home">
        <div class="text-2xl lg:text-3xl font-bold gradient-text">
          THE FUTURE 3D
        </div>
      </a>

      <!-- Desktop Navigation -->
      <div class="hidden lg:flex items-center space-x-8">
        <a href="/" class="text-gray-700 hover:text-blue-600 transition-colors duration-300 font-medium">Home</a>
        
        <!-- Services Mega Menu -->
        <div class="relative group">
          <button 
            class="text-gray-700 hover:text-blue-600 transition-colors duration-300 font-medium flex items-center"
            aria-label="Services menu"
            aria-expanded="false"
            aria-haspopup="true"
          >
            Services
            <svg class="ml-1 w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
            </svg>
          </button>
          
          <!-- Mega Menu Dropdown -->
          <div 
            class="absolute left-1/2 transform -translate-x-1/2 mt-2 w-screen max-w-6xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50 px-4"
            role="menu"
            aria-label="Services submenu"
          >
            <div class="backdrop-blur-lg bg-white/95 border border-gray-200 rounded-2xl shadow-2xl p-8">
              <div class="grid md:grid-cols-3 gap-8">
                <!-- Column 1: Core Services -->
                <div>
                  <h3 class="text-sm font-semibold text-gray-900 uppercase tracking-wide mb-4">Core Services</h3>
                  <ul class="space-y-2">
                    <li><a href="/3d-scan-to-bim" class="block text-gray-700 hover:text-blue-600 transition-colors py-2 focus:outline-2 focus:outline-blue-500 focus:outline-offset-2 rounded" role="menuitem">3D Laser Scanning</a></li>
                    <li><a href="/3d-virtual-tour" class="block text-gray-700 hover:text-blue-600 transition-colors py-2 focus:outline-2 focus:outline-blue-500 focus:outline-offset-2 rounded" role="menuitem">Matterport Virtual Tours</a></li>
                    <li><a href="/drone" class="block text-gray-700 hover:text-blue-600 transition-colors py-2 focus:outline-2 focus:outline-blue-500 focus:outline-offset-2 rounded" role="menuitem">Drone Services</a></li>
                    <li><a href="/google-street-view" class="block text-gray-700 hover:text-blue-600 transition-colors py-2 focus:outline-2 focus:outline-blue-500 focus:outline-offset-2 rounded" role="menuitem">Google Street View</a></li>
                  </ul>
                </div>
                
                <!-- Column 2: Service Types -->
                <div>
                  <h3 class="text-sm font-semibold text-gray-900 uppercase tracking-wide mb-4">Service Types</h3>
                  <ul class="space-y-2">
                    <li><a href="/3d-scan-to-bim" class="block text-gray-700 hover:text-blue-600 transition-colors py-2 focus:outline-2 focus:outline-blue-500 focus:outline-offset-2 rounded" role="menuitem">Scan to BIM</a></li>
                    <li><a href="/services" class="block text-gray-700 hover:text-blue-600 transition-colors py-2 focus:outline-2 focus:outline-blue-500 focus:outline-offset-2 rounded" role="menuitem">As-Built Documentation</a></li>
                    <li><a href="/drone" class="block text-gray-700 hover:text-blue-600 transition-colors py-2 focus:outline-2 focus:outline-blue-500 focus:outline-offset-2 rounded" role="menuitem">Construction Tracking</a></li>
                    <li><a href="/drone" class="block text-gray-700 hover:text-blue-600 transition-colors py-2 focus:outline-2 focus:outline-blue-500 focus:outline-offset-2 rounded" role="menuitem">Aerial Mapping</a></li>
                  </ul>
                </div>
                
                <!-- Column 3: Quick Links & Search -->
                <div>
                  <h3 class="text-sm font-semibold text-gray-900 uppercase tracking-wide mb-4">Quick Links</h3>
                  <ul class="space-y-2 mb-6">
                    <li><a href="/services" class="block text-gray-700 hover:text-blue-600 transition-colors py-2 font-semibold focus:outline-2 focus:outline-blue-500 focus:outline-offset-2 rounded" role="menuitem">View All Services →</a></li>
                    <li><a href="/pricing" class="block text-gray-700 hover:text-blue-600 transition-colors py-2 focus:outline-2 focus:outline-blue-500 focus:outline-offset-2 rounded" role="menuitem">Pricing Guide</a></li>
                    <li><a href="/technology" class="block text-gray-700 hover:text-blue-600 transition-colors py-2 focus:outline-2 focus:outline-blue-500 focus:outline-offset-2 rounded" role="menuitem">Our Technology</a></li>
                  </ul>
                  
                  <!-- Quick Search in Mega Menu -->
                  <div class="border-t border-gray-200 pt-4">
                    <label for="services-search" class="text-xs font-semibold text-gray-900 uppercase tracking-wide mb-2 block">Quick Search</label>
                    <input
                      type="text"
                      id="services-search"
                      placeholder="Search services..."
                      class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"
                      onkeypress="if(event.key==='Enter') { window.location.href='/services?q='+this.value; }"
                      aria-label="Search services"
                    />
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Industries Mega Menu -->
        <div class="relative group">
          <button 
            class="text-gray-700 hover:text-blue-600 transition-colors duration-300 font-medium flex items-center"
            aria-label="Industries menu"
            aria-expanded="false"
            aria-haspopup="true"
          >
            Industries
            <svg class="ml-1 w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" aria-hidden="true">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
            </svg>
          </button>
          
          <!-- Mega Menu Dropdown -->
          <div 
            class="absolute left-1/2 transform -translate-x-1/2 mt-2 w-screen max-w-5xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-50 px-4"
            role="menu"
            aria-label="Industries submenu"
          >
            <div class="backdrop-blur-lg bg-white/95 border border-gray-200 rounded-2xl shadow-2xl p-8">
              <div class="grid md:grid-cols-3 gap-8">
                <!-- Column 1: Primary Industries -->
                <div>
                  <h3 class="text-sm font-semibold text-gray-900 uppercase tracking-wide mb-4">Primary Markets</h3>
                  <ul class="space-y-2">
                    <li><a href="/industries/real-estate" class="block text-gray-700 hover:text-blue-600 transition-colors py-2 focus:outline-2 focus:outline-blue-500 focus:outline-offset-2 rounded" role="menuitem">Real Estate</a></li>
                    <li><a href="/industries/architecture" class="block text-gray-700 hover:text-blue-600 transition-colors py-2 focus:outline-2 focus:outline-blue-500 focus:outline-offset-2 rounded" role="menuitem">Architecture</a></li>
                    <li><a href="/industries/construction" class="block text-gray-700 hover:text-blue-600 transition-colors py-2 focus:outline-2 focus:outline-blue-500 focus:outline-offset-2 rounded" role="menuitem">Construction</a></li>
                    <li><a href="/industries/engineering" class="block text-gray-700 hover:text-blue-600 transition-colors py-2 focus:outline-2 focus:outline-blue-500 focus:outline-offset-2 rounded" role="menuitem">Engineering</a></li>
                  </ul>
                </div>
                
                <!-- Column 2: Additional Industries -->
                <div>
                  <h3 class="text-sm font-semibold text-gray-900 uppercase tracking-wide mb-4">Additional Industries</h3>
                  <ul class="space-y-2">
                    <li><a href="/industries/insurance" class="block text-gray-700 hover:text-blue-600 transition-colors py-2 focus:outline-2 focus:outline-blue-500 focus:outline-offset-2 rounded" role="menuitem">Insurance</a></li>
                    <li><a href="/industries/property-management" class="block text-gray-700 hover:text-blue-600 transition-colors py-2 focus:outline-2 focus:outline-blue-500 focus:outline-offset-2 rounded" role="menuitem">Property Management</a></li>
                    <li><a href="/industries/hospitality" class="block text-gray-700 hover:text-blue-600 transition-colors py-2 focus:outline-2 focus:outline-blue-500 focus:outline-offset-2 rounded" role="menuitem">Hospitality</a></li>
                    <li><a href="/industries/manufacturing" class="block text-gray-700 hover:text-blue-600 transition-colors py-2 focus:outline-2 focus:outline-blue-500 focus:outline-offset-2 rounded" role="menuitem">Manufacturing</a></li>
                    <li><a href="/industries/retail" class="block text-gray-700 hover:text-blue-600 transition-colors py-2 focus:outline-2 focus:outline-blue-500 focus:outline-offset-2 rounded" role="menuitem">Retail</a></li>
                    <li><a href="/industries/education" class="block text-gray-700 hover:text-blue-600 transition-colors py-2 focus:outline-2 focus:outline-blue-500 focus:outline-offset-2 rounded" role="menuitem">Education</a></li>
                  </ul>
                </div>
                
                <!-- Column 3: Quick Links -->
                <div>
                  <h3 class="text-sm font-semibold text-gray-900 uppercase tracking-wide mb-4">Resources</h3>
                  <ul class="space-y-2">
                    <li><a href="/industries" class="block text-gray-700 hover:text-blue-600 transition-colors py-2 font-semibold focus:outline-2 focus:outline-blue-500 focus:outline-offset-2 rounded" role="menuitem">All Industries →</a></li>
                    <li><a href="/case-studies" class="block text-gray-700 hover:text-blue-600 transition-colors py-2 focus:outline-2 focus:outline-blue-500 focus:outline-offset-2 rounded" role="menuitem">Case Studies</a></li>
                    <li><a href="/contact" class="block text-gray-700 hover:text-blue-600 transition-colors py-2 focus:outline-2 focus:outline-blue-500 focus:outline-offset-2 rounded" role="menuitem">Industry Inquiry</a></li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </div>

        <a href="/locations" class="text-gray-700 hover:text-blue-600 transition-colors duration-300 font-medium">Locations</a>
        <a href="/technology" class="text-gray-700 hover:text-blue-600 transition-colors duration-300 font-medium">Technology</a>
        <a href="/contact" class="text-gray-700 hover:text-blue-600 transition-colors duration-300 font-medium">Contact</a>
      </div>

      <!-- CTA Button (Desktop) -->
      <div class="hidden lg:flex items-center space-x-4">
        <!-- Phone Number -->
        <a 
          href="tel:+13479981464" 
          class="flex items-center gap-2 text-gray-700 hover:text-blue-600 transition-colors duration-300 font-medium"
          aria-label="Call us at 347-998-1464"
        >
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path>
          </svg>
          <span class="hidden xl:inline">(347) 998-1464</span>
          <span class="xl:hidden">Call</span>
        </a>
        
        <!-- Search Icon -->
        <button 
          onclick="window.openSearch?.()"
          class="text-gray-700 hover:text-blue-600 transition-colors duration-300 p-2 hover:scale-110"
          aria-label="Search"
        >
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
          </svg>
        </button>
        
        <!-- Language Selector -->
        <LanguageSelector />
        
        <!-- Dark Mode Toggle -->
        <DarkModeToggle />
        
        <a 
          href="/contact" 
          class="bg-gradient-to-r from-blue-600 to-purple-600 text-white px-6 py-2.5 rounded-lg font-semibold shadow-md hover:shadow-lg hover:scale-105 transition-all duration-300 focus:outline-2 focus:outline-blue-500 focus:outline-offset-2"
          aria-label="Get a free quote"
        >
          Get Quote
        </a>
      </div>

      <!-- Mobile Actions -->
      <div class="lg:hidden flex items-center space-x-3">
        <!-- Dark Mode Toggle (Mobile) -->
        <DarkModeToggle />
        
        <!-- Mobile Phone Number -->
        <a 
          href="tel:+13479981464" 
          class="flex items-center gap-2 bg-blue-600 text-white px-3 py-2 rounded-lg font-semibold hover:bg-blue-700 transition-colors text-sm"
          aria-label="Call us at 347-998-1464"
        >
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path>
          </svg>
          <span class="hidden sm:inline">Call</span>
        </a>
        
        <!-- Mobile Menu Button -->
        <button 
          id="mobile-menu-button"
          class="text-gray-700 hover:text-black p-2"
          aria-label="Toggle menu"
          aria-expanded="false"
        >
          <svg id="menu-icon" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
          </svg>
          <svg id="close-icon" class="w-6 h-6 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
          </svg>
        </button>
      </div>
    </div>

    <!-- Mobile Menu -->
    <div id="mobile-menu" class="hidden lg:hidden border-t border-gray-200 bg-white">
      <div class="py-4 space-y-1">
        <a href="/" class="block px-4 py-3 text-gray-700 hover:bg-gray-50 hover:text-black rounded-lg transition">Home</a>
        
        <!-- Mobile Services -->
        <div class="px-4">
          <button class="mobile-dropdown-toggle w-full flex items-center justify-between py-3 text-gray-700 hover:text-black">
            <span>Services</span>
            <svg class="w-4 h-4 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
            </svg>
          </button>
          <div class="mobile-dropdown-content hidden pl-4 space-y-1">
            <a href="/drone" class="block py-2 text-gray-600 hover:text-black">Drone Services</a>
            <a href="/3d-scan-to-bim" class="block py-2 text-gray-600 hover:text-black">3D Scanning</a>
            <a href="/3d-virtual-tour" class="block py-2 text-gray-600 hover:text-black">Matterport Tours</a>
            <a href="/google-street-view" class="block py-2 text-gray-600 hover:text-black">Street View</a>
            <a href="/services" class="block py-2 text-gray-600 hover:text-black">All Services</a>
          </div>
        </div>

        <!-- Mobile Industries -->
        <div class="px-4">
          <button class="mobile-dropdown-toggle w-full flex items-center justify-between py-3 text-gray-700 hover:text-black">
            <span>Industries</span>
            <svg class="w-4 h-4 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
            </svg>
          </button>
          <div class="mobile-dropdown-content hidden pl-4 space-y-1">
            <a href="/industries/real-estate" class="block py-2 text-gray-600 hover:text-black">Real Estate</a>
            <a href="/industries/architecture" class="block py-2 text-gray-600 hover:text-black">Architecture</a>
            <a href="/industries/construction" class="block py-2 text-gray-600 hover:text-black">Construction</a>
            <a href="/industries/engineering" class="block py-2 text-gray-600 hover:text-black">Engineering</a>
            <a href="/industries" class="block py-2 text-gray-600 hover:text-black">All Industries</a>
          </div>
        </div>

        <a href="/locations" class="block px-4 py-3 text-gray-700 hover:bg-gray-50 hover:text-black rounded-lg transition">Locations</a>
        <a href="/technology" class="block px-4 py-3 text-gray-700 hover:bg-gray-50 hover:text-black rounded-lg transition">Technology</a>
        <a href="/contact" class="block px-4 py-3 text-gray-700 hover:bg-gray-50 hover:text-black rounded-lg transition">Contact</a>
        
        <!-- Mobile Search -->
        <div class="px-4">
          <button 
            onclick="window.openSearch?.()"
            class="w-full flex items-center justify-center gap-2 px-4 py-3 text-gray-700 hover:bg-gray-50 hover:text-black rounded-lg transition"
            aria-label="Search"
          >
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
            </svg>
            <span>Search</span>
          </button>
        </div>
        
        <!-- Mobile CTA -->
        <div class="px-4 pt-2">
          <a href="/contact" class="block w-full text-center bg-black hover:bg-gray-900 text-white px-6 py-3 rounded-lg font-semibold transition-all duration-200">
            Get Quote
          </a>
        </div>
      </div>
    </div>
  </nav>
</header>

<style>
  /* Styles now handled by Tailwind classes */
</style>

<script>
  // Mobile menu toggle
  const mobileMenuButton = document.getElementById('mobile-menu-button');
  const mobileMenu = document.getElementById('mobile-menu');
  const menuIcon = document.getElementById('menu-icon');
  const closeIcon = document.getElementById('close-icon');

  if (mobileMenuButton && mobileMenu) {
    mobileMenuButton.addEventListener('click', () => {
      const isHidden = mobileMenu.classList.contains('hidden');
      
      if (isHidden) {
        mobileMenu.classList.remove('hidden');
        menuIcon?.classList.add('hidden');
        closeIcon?.classList.remove('hidden');
        mobileMenuButton.setAttribute('aria-expanded', 'true');
      } else {
        mobileMenu.classList.add('hidden');
        menuIcon?.classList.remove('hidden');
        closeIcon?.classList.add('hidden');
        mobileMenuButton.setAttribute('aria-expanded', 'false');
      }
    });
  }

  // Mobile dropdown toggles
  document.querySelectorAll('.mobile-dropdown-toggle').forEach(button => {
    button.addEventListener('click', () => {
      const content = button.nextElementSibling;
      const icon = button.querySelector('svg');
      
      if (content) {
        content.classList.toggle('hidden');
        if (icon) {
          icon.classList.toggle('rotate-180');
        }
      }
    });
  });

  // Close mobile menu when clicking outside
  document.addEventListener('click', (e) => {
    if (mobileMenu && !mobileMenu.contains(e.target) && !mobileMenuButton?.contains(e.target)) {
      if (!mobileMenu.classList.contains('hidden')) {
        mobileMenu.classList.add('hidden');
        menuIcon?.classList.remove('hidden');
        closeIcon?.classList.add('hidden');
        mobileMenuButton?.setAttribute('aria-expanded', 'false');
      }
    }
  });
</script>

<!-- Include Search component -->
<Search />

